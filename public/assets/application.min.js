var doStuff, formatUrl, printIssue, reset, userList;

reset = function() {
  return $('#collaboraters').html("");
};

formatUrl = function(baseUrl) {
  var repo, theSplit;
  theSplit = baseUrl.split('/');
  repo = theSplit[3] + "/" + theSplit[4];
  return "https://api.github.com/repos/" + repo + "/issues";
};

userList = [];

printIssue = function(user) {
  if ($.inArray(user.login, userList) >= 0) {
    return;
  }
  userList.push(user.login);
  return $('#collaboraters').append("<div data-name=\"" + user.login + "\" class=\"collaborator\" style=\"float:left;\">\n  <img width='50px' src='" + user.avatar_url + "'/>\n</div>");
};

doStuff = function(issuePath) {
  $.getJSON(issuePath, function(response) {
    var count, issue, _i, _len;
    count = 0;
    for (_i = 0, _len = response.length; _i < _len; _i++) {
      issue = response[_i];
      printIssue(issue.user);
      count++;
    }
    return $('#collaboraters').attr("data-open", count);
  });
  return $.getJSON(issuePath + "?state=closed", function(response) {
    var count, issue, _i, _len;
    count = 0;
    for (_i = 0, _len = response.length; _i < _len; _i++) {
      issue = response[_i];
      printIssue(issue.user);
      count++;
    }
    return $('#collaboraters').attr("data-closed", count);
  });
};

$(function() {
  var init;
  return init = (function() {
    var issuePath;
    issuePath = 'https://api.github.com/repos/laravel/framework/issues';
    doStuff(issuePath);
    return $(document).on("change", "[name='repo']", function(e) {
      var path;
      path = $("[name='repo']").val();
      reset();
      return doStuff(formatUrl(path));
    });
  })();
});
